FROM node:18.14.2-alpine

ARG BUILD_BASE_PATH
ARG FRONTEND_CLIENT_PORT

ARG API_GATEWAY_URI
ARG NEXT_PUBLIC_API_GATEWAY_URI
ENV API_GATEWAY_URI=${API_GATEWAY_URI}
ENV NEXT_PUBLIC_API_GATEWAY_URI=${NEXT_PUBLIC_API_GATEWAY_URI}
ARG USER
ARG NEXT_PUBLIC_USER
ENV USER=${USER}
ENV NEXT_PUBLIC_USER=${NEXT_PUBLIC_USER}

WORKDIR /app

COPY $BUILD_BASE_PATH/package.json  .

RUN npm install

COPY $BUILD_BASE_PATH/ .

RUN npm run build

CMD npm start -- -p $FRONTEND_CLIENT_PORT
